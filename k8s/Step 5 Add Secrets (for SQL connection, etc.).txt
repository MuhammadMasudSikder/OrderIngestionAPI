kubectl create secret generic db-connection  --from-literal=connectionstring="Server=tcp:wearistyle-sql.database.windows.net,1433;Initial Catalog=wearistyledb;Persist Security Info=False;User ID=sqladminuser;Password=P@ssw0rd1234!;MultipleActiveResultSets=False;Encrypt=True;TrustServerCertificate=False;Connection Timeout=30;"  -n wearistyle-prod

kubectl rollout restart deployment wearistyle-api -n wearistyle-prod

kubectl get pods -n wearistyle-prod
kubectl logs -n wearistyle-prod wearistyle-api-646d998b5f-56xsl --previous

Verify AKS can connect to SQL Server

Test connectivity from inside the cluster:

kubectl run sqltest --rm -it --image=mcr.microsoft.com/mssql-tools -- bash


Then inside the pod:

sqlcmd -S tcp:wearistyle-sql.database.windows.net,1433 -U sqladminuser -P 'P@ssw0rd1234!' -d wearistyledb


If login fails, you have a network/firewall or credential issue.




Option 2: Delete and recreate the secret
kubectl delete secret db-connection -n wearistyle-prod

kubectl create secret generic db-connection --from-literal=connectionstring="Server=tcp:wearistyle-sql.database.windows.net,1433;Initial Catalog=wearistyledb;Persist Security Info=False;User ID=sqladminuser;Password=P@ssw0rd1234!;MultipleActiveResultSets=False;Encrypt=True;TrustServerCertificate=False;Connection Timeout=30;" -n wearistyle-prod --dry-run=client -o yaml | kubectl apply -f -

  
  Step 3: Restart the API deployment

After updating the secret, restart the deployment to pick up the new connection string:

kubectl rollout restart deployment wearistyle-api -n wearistyle-prod

Verify

Use your curltest pod again:
kubectl delete pod curltest -n wearistyle-prod --force --grace-period=0

kubectl run curltest --image=curlimages/curl -it --rm --restart=Never --namespace wearistyle-prod -- curl -v http://wearistyle-api:8080/api/product



admin@wearistyle.com
Admin@123#


Server=tcp:orderingestion-sql.database.windows.net,1433;Initial Catalog=orderingestiondb;Persist Security Info=False;User ID=sqladminuser;Password={your_password};MultipleActiveResultSets=False;Encrypt=True;TrustServerCertificate=False;Connection Timeout=30;